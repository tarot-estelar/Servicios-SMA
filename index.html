<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Servicios SMA - Reserva</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
    <!-- 1. A√ëADIR ESTILOS DE FLATPICKR -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <style>
        body {
            font-family: 'Montserrat', sans-serif;
            background-color: #f3f8f6;
            margin: 0;
            padding: 0;
        }
        header {
            background-color: #2d8659;
            color: white;
            padding: 30px 15px;
            text-align: center;
            font-size: 1.5rem;
        }
        main {
            max-width: 500px;
            margin: 30px auto;
            padding: 20px;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1  );
        }
        label {
            display: block;
            margin-top: 15px;
            font-weight: bold;
        }
        /* Se aplica el estilo tambi√©n al input de flatpickr */
        input, .flatpickr-input, button {
            width: 100%;
            padding: 10px;
            margin-top: 5px;
            border: 1px solid #ccc;
            border-radius: 8px;
            font-family: 'Montserrat', sans-serif;
            background-color: white; /* Asegura fondo blanco para el input */
            box-sizing: border-box; /* Importante para que el padding no desborde */
        }
        .servicio {
            display: flex;
            align-items: center;
            margin-top: 8px;
        }
        .servicio input {
            width: auto;
            margin-right: 10px;
        }
        button {
            background-color: #2d8659;
            color: white;
            border: none;
            font-size: 1rem;
            cursor: pointer;
            margin-top: 20px;
            font-weight: bold;
        }
        button:hover {
            background-color: #256f48;
        }
        .nota-valores {
            text-align: center;
            margin-top: 15px;
            font-size: 0.9rem;
            color: #555;
        }
        .total-container {
            margin-top: 25px;
            padding-top: 15px;
            border-top: 2px solid #eee;
            text-align: right;
            font-size: 1.2rem;
            font-weight: bold;
        }
        .direccion-container, .franja-horaria-container {
            display: flex;
            align-items: center;
            margin-top: 5px;
        }
        .direccion-container input, .franja-horaria-container input {
            flex-grow: 1;
            margin-right: 10px;
        }
        .direccion-fija, .opcional-text {
            white-space: nowrap;
            font-size: 0.9em;
            color: #555;
        }
    </style>
</head>
<body>

<header>Servicios SMA - Reserva tu d√≠a</header>

<main>
    <form id="reservaForm">
        <label for="nombre">Tu nombre</label>
        <input type="text" id="nombre" required>

        <label for="fecha">Fecha</label>
        <!-- Este input ser√° transformado por flatpickr -->
        <input type="text" id="fecha" required placeholder="Selecciona una fecha...">

        <!-- CAMPO DE DIRECCI√ìN -->
        <label for="direccion">Direcci√≥n</label>
        <div class="direccion-container">
            <input type="text" id="direccion" required>
            <span class="direccion-fija">San Mart√≠n de los Andes, Neuqu√©n</span>
        </div>

        <!-- NUEVO CAMPO DE FRANJA HORARIA -->
        <label for="franjaHoraria">Franja horaria</label>
        <div class="franja-horaria-container">
            <input type="text" id="franjaHoraria" placeholder="Ej: 09:00 hs - 12:00 hs">
            <span class="opcional-text"> *opcional</span>
        </div>

        <label>Selecciona los servicios</label>
        <div class="servicio">
            <input type="checkbox" name="servicio" value="Riego y cuidado de plantas" data-precio="5000">
            üåø Riego y cuidado de plantas - $5000
        </div>
        <div class="servicio">
            <input type="checkbox" name="servicio" value="Paseo y alimentaci√≥n de mascotas" data-precio="5000">
            üêï Paseo y alimentaci√≥n de mascotas - $5000
        </div>
        <div class="servicio">
            <input type="checkbox" name="servicio" value="Limpieza y mantenimiento b√°sico del hogar" data-precio="20000">
           üßπ Limpieza b√°sica del hogar - $20000
        </div>
        <div class="servicio">
            <input type="checkbox" name="servicio" value="Recepci√≥n y guardado de paquetes" data-precio="3000">
           üì¶ Recepci√≥n y guardado de paquetes - $3000
        </div>

        <div class="total-container">
            Total: <span id="costoTotal">$0</span>
        </div>

        <button type="submit">Reservar por WhatsApp</button>
        <p class="nota-valores">* valores por visita</p>
    </form>
</main>

<!-- 2. A√ëADIR SCRIPT DE FLATPICKR -->
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
<!-- Opcional: a√±adir traducci√≥n a espa√±ol para el calendario -->
<script src="https://npmcdn.com/flatpickr/dist/l10n/es.js"></script>

<script>
    // --- ELEMENTOS DEL DOM ---
    const nombreInput = document.getElementById('nombre' );
    const fechaInput = document.getElementById('fecha');
    const direccionInput = document.getElementById('direccion');
    const franjaHorariaInput = document.getElementById('franjaHoraria'); // NUEVO
    const form = document.getElementById('reservaForm');
    const checkboxes = document.querySelectorAll('input[name="servicio"]');
    const costoTotalSpan = document.getElementById('costoTotal');

    // --- DATOS ---
    const telefono = "5493525615318"; // Cambia por tu n√∫mero real

    // --- 3. CONFIGURACI√ìN DE FECHAS BLOQUEADAS ---
    const fechasBloqueadas = [
        "2025-08-15",
        "2025-08-20",
        "2025-08-25",
        {
            from: "2025-10-03",
            to: "2025-10-21"
        }
    ]; 

    // --- INICIALIZACI√ìN DE FLATPICKR ---
    flatpickr("#fecha", {
        "locale": "es",
        dateFormat: "Y-m-d",
        minDate: "today",
        disable: fechasBloqueadas,
    });


    // --- FUNCIONES ---
    function calcularTotal() {
        let total = 0;
        checkboxes.forEach(checkbox => {
            if (checkbox.checked) {
                total += parseInt(checkbox.dataset.precio, 10);
            }
        });
        costoTotalSpan.textContent = `$${total}`;
        return total;
    }

    // --- GUARDAR Y CARGAR DATOS DEL FORMULARIO ---
    function guardarDatos() {
        const serviciosSeleccionados = Array.from(checkboxes)
            .filter(cb => cb.checked)
            .map(cb => cb.value);
        
        localStorage.setItem('reservaNombre', nombreInput.value);
        localStorage.setItem('reservaFecha', fechaInput.value);
        localStorage.setItem('reservaDireccion', direccionInput.value);
        localStorage.setItem('reservaFranjaHoraria', franjaHorariaInput.value); // NUEVO
        localStorage.setItem('reservaServicios', JSON.stringify(serviciosSeleccionados));
    }

    function cargarDatos() {
        const nombreGuardado = localStorage.getItem('reservaNombre');
        const fechaGuardada = localStorage.getItem('reservaFecha');
        const direccionGuardada = localStorage.getItem('reservaDireccion');
        const franjaHorariaGuardada = localStorage.getItem('reservaFranjaHoraria'); // NUEVO
        const serviciosGuardados = JSON.parse(localStorage.getItem('reservaServicios'));

        if (nombreGuardado) nombreInput.value = nombreGuardado;
        if (fechaGuardada) fechaInput.value = fechaGuardada;
        if (direccionGuardada) direccionInput.value = direccionGuardada;
        if (franjaHorariaGuardada) franjaHorariaInput.value = franjaHorariaGuardada; // NUEVO
        if (serviciosGuardados && serviciosGuardados.length > 0) {
            checkboxes.forEach(cb => {
                if (serviciosGuardados.includes(cb.value)) cb.checked = true;
            });
        }
    }
    
    // --- EVENT LISTENERS ---
    nombreInput.addEventListener('input', guardarDatos);
    fechaInput.addEventListener('change', guardarDatos); // flatpickr usa 'change'
    direccionInput.addEventListener('input', guardarDatos);
    franjaHorariaInput.addEventListener('input', guardarDatos); // NUEVO
    checkboxes.forEach(checkbox => {
        checkbox.addEventListener('change', () => {
            calcularTotal();
            guardarDatos();
        });
    });

    form.addEventListener('submit', function(e) {
        e.preventDefault();
        if (calcularTotal() === 0) {
            alert("Por favor selecciona al menos un servicio.");
            return;
        }
        if (!fechaInput.value) {
            alert("Por favor selecciona una fecha.");
            return;
        }
        if (!direccionInput.value) {
            alert("Por favor ingresa tu direcci√≥n.");
            return;
        }

        const nombre = nombreInput.value;
        const fecha = fechaInput.value;
        const direccion = `${direccionInput.value}, San Mart√≠n de los Andes, Neuqu√©n`;
        const franjaHoraria = franjaHorariaInput.value; // NUEVO
        const total = costoTotalSpan.textContent;
        const serviciosSeleccionados = Array.from(checkboxes)
            .filter(cb => cb.checked)
            .map(el => el.value).join(', ');

        let mensaje = `Holaüëã! soy ${nombre}. Quiero reservar para el d√≠a ${fecha} en la direcci√≥n ${direccion} los siguientes servicios: ${serviciosSeleccionados}.`;
        if (franjaHoraria) { // Solo a√±ade la franja horaria si el campo no est√° vac√≠o
            mensaje += ` En la franja horaria: ${franjaHoraria}.`;
        }
        mensaje += ` El total es ${total}.`;

        const url = `https://wa.me/${telefono}?text=${encodeURIComponent(mensaje )}`;

        window.open(url, '_blank');

        localStorage.removeItem('reservaNombre');
        localStorage.removeItem('reservaFecha');
        localStorage.removeItem('reservaDireccion');
        localStorage.removeItem('reservaFranjaHoraria'); // NUEVO
        localStorage.removeItem('reservaServicios');
    });

    // --- INICIALIZACI√ìN ---
    document.addEventListener('DOMContentLoaded', () => {
        cargarDatos();
        calcularTotal();
    });
</script>

</body>
</html>




