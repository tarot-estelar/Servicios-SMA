<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Servicios SMA - Reserva</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Montserrat', sans-serif;
            background-color: #f3f8f6;
            margin: 0;
            padding: 0;
        }
        header {
            background-color: #2d8659;
            color: white;
            padding: 30px 15px;
            text-align: center;
            font-size: 1.5rem;
        }
        main {
            max-width: 500px;
            margin: 30px auto;
            padding: 20px;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1 );
        }
        label {
            display: block;
            margin-top: 15px;
            font-weight: bold;
        }
        input, select, button {
            width: 100%;
            padding: 10px;
            margin-top: 5px;
            border: 1px solid #ccc;
            border-radius: 8px;
            font-family: 'Montserrat', sans-serif;
        }
        .servicio {
            display: flex;
            align-items: center;
            margin-top: 8px;
        }
        .servicio input {
            width: auto;
            margin-right: 10px;
        }
        button {
            background-color: #2d8659;
            color: white;
            border: none;
            font-size: 1rem;
            cursor: pointer;
            margin-top: 20px;
            font-weight: bold;
        }
        button:hover {
            background-color: #256f48;
        }
        .nota-valores {
            text-align: center;
            margin-top: 15px;
            font-size: 0.9rem;
            color: #555;
        }
        .fecha-error {
            color: #d9534f;
            font-size: 0.9rem;
            margin-top: 5px;
            display: none;
        }
        .total-container {
            margin-top: 25px;
            padding-top: 15px;
            border-top: 2px solid #eee;
            text-align: right;
            font-size: 1.2rem;
            font-weight: bold;
        }
    </style>
</head>
<body>

<header>Servicios SMA - Reserva tu d√≠a</header>

<main>
    <form id="reservaForm">
        <label for="nombre">Tu nombre</label>
        <input type="text" id="nombre" required>

        <label for="fecha">Fecha</label>
        <input type="date" id="fecha" required>
        <div id="fechaError" class="fecha-error">Esta fecha no est√° disponible. Por favor elige otra.</div>

        <label>Selecciona los servicios</label>
        <div class="servicio">
            <input type="checkbox" name="servicio" value="Riego y cuidado de plantas" data-precio="5000">
            üåø Riego y cuidado de plantas - $5000
        </div>
        <div class="servicio">
            <input type="checkbox" name="servicio" value="Paseo y alimentaci√≥n de mascotas" data-precio="5000">
            üêï Paseo y alimentaci√≥n de mascotas - $5000
        </div>
        <div class="servicio">
            <input type="checkbox" name="servicio" value="Limpieza y mantenimiento b√°sico del hogar" data-precio="20000">
           üßπ Limpieza y mantenimiento b√°sico del hogar - $20000
        </div>
        <div class="servicio">
            <input type="checkbox" name="servicio" value="Recepci√≥n y guardado de paquetes" data-precio="3000">
           üì¶ Recepci√≥n y guardado de paquetes - $3000
        </div>

        <div class="total-container">
            Total: <span id="costoTotal">$0</span>
        </div>

        <button type="submit">Reservar por WhatsApp</button>
        <p class="nota-valores">* valores por visita</p>
    </form>
</main>

<script>
    // --- ELEMENTOS DEL DOM ---
    const nombreInput = document.getElementById('nombre');
    const fechaInput = document.getElementById('fecha');
    const fechaError = document.getElementById('fechaError');
    const form = document.getElementById('reservaForm');
    const checkboxes = document.querySelectorAll('input[name="servicio"]');
    const costoTotalSpan = document.getElementById('costoTotal');

    // --- DATOS ---
    const fechasOcupadas = ["2025-08-15", "2025-08-20", "2025-08-25"];
    const telefono = "5493525615318"; // 

    // --- FUNCIONES ---

    function validarFecha() {
        if (fechasOcupadas.includes(fechaInput.value)) {
            fechaError.style.display = 'block';
            return false;
        } else {
            fechaError.style.display = 'none';
            return true;
        }
    }

    function calcularTotal() {
        let total = 0;
        checkboxes.forEach(checkbox => {
            if (checkbox.checked) {
                total += parseInt(checkbox.dataset.precio, 10);
            }
        });
        costoTotalSpan.textContent = `$${total}`;
        return total;
    }

    // --- NUEVO: GUARDAR Y CARGAR DATOS DEL FORMULARIO ---

    // Funci√≥n para guardar los datos en localStorage
    function guardarDatos() {
        const serviciosSeleccionados = Array.from(checkboxes)
            .filter(cb => cb.checked)
            .map(cb => cb.value);
        
        localStorage.setItem('reservaNombre', nombreInput.value);
        localStorage.setItem('reservaFecha', fechaInput.value);
        localStorage.setItem('reservaServicios', JSON.stringify(serviciosSeleccionados));
    }

    // Funci√≥n para cargar los datos desde localStorage al iniciar
    function cargarDatos() {
        const nombreGuardado = localStorage.getItem('reservaNombre');
        const fechaGuardada = localStorage.getItem('reservaFecha');
        const serviciosGuardados = JSON.parse(localStorage.getItem('reservaServicios'));

        if (nombreGuardado) {
            nombreInput.value = nombreGuardado;
        }
        if (fechaGuardada) {
            fechaInput.value = fechaGuardada;
        }
        if (serviciosGuardados && serviciosGuardados.length > 0) {
            checkboxes.forEach(cb => {
                if (serviciosGuardados.includes(cb.value)) {
                    cb.checked = true;
                }
            });
        }
    }
    
    // --- EVENT LISTENERS ---

    // Poner la fecha m√≠nima como hoy
    const hoy = new Date().toISOString().split('T')[0];
    fechaInput.setAttribute('min', hoy);

    // A√±adir listeners para guardar datos en cada cambio
    nombreInput.addEventListener('input', guardarDatos);
    fechaInput.addEventListener('input', () => {
        validarFecha();
        guardarDatos(); // Tambi√©n guardar al cambiar la fecha
    });
    checkboxes.forEach(checkbox => {
        checkbox.addEventListener('change', () => {
            calcularTotal();
            guardarDatos(); // Tambi√©n guardar al cambiar servicios
        });
    });

    // Gestionar el env√≠o del formulario
    form.addEventListener('submit', function(e) {
        e.preventDefault();
        if (!validarFecha()) {
            fechaInput.focus();
            return;
        }
        if (calcularTotal() === 0) {
            alert("Por favor selecciona al menos un servicio.");
            return;
        }

        const nombre = nombreInput.value;
        const fecha = fechaInput.value;
        const total = costoTotalSpan.textContent;
        const serviciosSeleccionados = Array.from(checkboxes)
            .filter(cb => cb.checked)
            .map(el => el.value).join(', ');

        const mensaje = `Holaüëã! soy ${nombre}. 
        Quiero reservar para el d√≠a ${fecha} los siguientes servicios:
        ${serviciosSeleccionados}. 
        El total es ${total}.`;
        const url = `https://wa.me/${telefono}?text=${encodeURIComponent(mensaje )}`;

        window.open(url, '_blank');

        // Limpiar localStorage despu√©s de un env√≠o exitoso
        localStorage.removeItem('reservaNombre');
        localStorage.removeItem('reservaFecha');
        localStorage.removeItem('reservaServicios');
    });

    // --- INICIALIZACI√ìN ---
    // Cargar datos guardados al abrir la p√°gina
    document.addEventListener('DOMContentLoaded', () => {
        cargarDatos();
        // Validar y calcular con los datos cargados
        validarFecha();
        calcularTotal();
    });

</script>

</body>
</html>




